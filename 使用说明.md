# MarkItDown GUI 使用说明

## 项目概述

MarkItDown GUI 是基于Microsoft MarkItDown的图形界面程序，可以将各种文件格式转换为Markdown格式。该程序已经成功构建为独立的exe文件，无需安装Python环境即可直接运行。

## 已完成的文件

1. **markitdown_gui.py** - 主要的GUI程序文件
2. **build_exe.py** - 用于构建exe文件的脚本
3. **build.bat** - Windows批处理文件，简化构建过程
4. **test_gui.py** - 测试脚本，验证程序依赖
5. **README_GUI.md** - 详细的英文说明文档
6. **dist/MarkItDown-GUI.exe** - 已构建完成的可执行文件（92MB）

## 如何使用

### 方法1：直接运行exe文件（推荐）

1. 直接双击 `dist/MarkItDown-GUI.exe` 运行程序
2. 无需安装任何依赖，开箱即用

### 方法2：运行Python脚本

如果您有Python环境，也可以直接运行源码：

```bash
# 1. 安装依赖
pip install -e packages/markitdown[all]

# 2. 运行GUI程序
python markitdown_gui.py
```

## 程序功能

### 支持的文件格式

- **PDF文档** - 转换PDF内容为Markdown
- **Word文档** (.docx) - 提取文档内容和格式
- **Excel表格** (.xlsx, .xls) - 将表格数据转换为Markdown表格
- **PowerPoint演示文稿** (.pptx) - 提取幻灯片内容
- **图片文件** (.jpg, .png, .gif等) - 提取图片信息
- **音频文件** (.mp3, .wav等) - 音频转录功能
- **网页文件** (.html) - HTML转Markdown
- **文本文件** (.txt, .csv, .json等) - 格式化转换
- **压缩文件** (.zip) - 解压并转换内部文件
- **电子书** (.epub) - 提取电子书内容

### 程序界面

```
┌─────────────────────────────────────────────────────────┐
│                MarkItDown - 文件转换工具                   │
├─────────────────────────────────────────────────────────┤
│  文件选择                                                │
│  输入文件: [文件路径显示区域           ] [浏览...]          │
│  提示：或者直接拖拽文件到此窗口                              │
├─────────────────────────────────────────────────────────┤
│  转换选项                                                │
│  ☐ 保留数据URI（如base64编码的图片）                        │
│  ☐ 启用第三方插件                                         │
├─────────────────────────────────────────────────────────┤
│  [转换为Markdown] [保存结果] [清空]                        │
├─────────────────────────────────────────────────────────┤
│  转换结果                                                │
│  ┌─────────────────────────────────────────────────────┐ │
│  │                                                     │ │
│  │            转换后的Markdown内容显示区域                │ │
│  │                                                     │ │
│  │                                                     │ │
│  └─────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────┤
│  状态: 就绪                                     [关于]    │
└─────────────────────────────────────────────────────────┘
```

### 使用步骤

1. **选择文件**
   - 点击"浏览..."按钮选择要转换的文件
   - 或者直接将文件拖拽到程序窗口中

2. **设置选项**（可选）
   - 保留数据URI：保留base64编码的图片等内嵌数据
   - 启用第三方插件：使用额外的转换插件

3. **开始转换**
   - 点击"转换为Markdown"按钮
   - 程序会显示转换进度

4. **查看结果**
   - 转换完成后，结果会显示在下方的文本区域
   - 可以滚动查看完整内容

5. **保存文件**
   - 点击"保存结果"按钮
   - 选择保存位置，程序会建议文件名
   - 保存为.md格式的Markdown文件

## 技术特性

### 构建信息
- **文件大小**: 92MB
- **构建工具**: PyInstaller
- **Python版本**: 3.12
- **支持系统**: Windows 10/11

### 内置功能
- 多线程转换，不会冻结界面
- 实时进度显示
- 错误处理和用户友好的错误信息
- 中文界面支持
- 自动文件类型检测

### 安全性
- 无需网络连接（除非处理在线内容）
- 不收集用户数据
- 本地处理，保护隐私

## 故障排除

### 常见问题

1. **程序启动慢**
   - 第一次运行时会比较慢（约10-30秒）
   - 这是正常现象，程序在解压依赖包
   - 后续运行会快很多

2. **转换失败**
   - 检查文件是否损坏
   - 某些加密的PDF无法转换
   - 确保文件格式受支持

3. **中文显示乱码**
   - 程序已优化中文支持
   - 如有问题，请检查系统编码设置

4. **内存占用较高**
   - 处理大文件时属正常现象
   - 建议处理文件大小不超过100MB

### 获取帮助

如果遇到问题：
1. 查看程序状态栏的错误信息
2. 参考 [Microsoft MarkItDown项目](https://github.com/microsoft/markitdown)
3. 检查文件格式是否在支持列表中

## 构建过程

如果您想重新构建exe文件：

### 自动构建（推荐）
```bash
# Windows用户
双击运行 build.bat

# 或手动运行
python build_exe.py
```

### 手动构建
```bash
# 1. 安装依赖
pip install pyinstaller
pip install -e packages/markitdown[all]

# 2. 运行测试
python test_gui.py

# 3. 构建exe
python build_exe.py
```

## 版本信息

- **版本**: 1.0.0
- **构建日期**: 2025年1月
- **基于**: Microsoft MarkItDown
- **许可证**: MIT License

## 更新计划

未来可能的改进：
- 批量文件转换
- 更多输出格式（HTML、PDF等）
- 插件系统扩展
- 更好的拖拽支持
- 转换历史记录

---

**感谢使用 MarkItDown GUI！**

这个程序让文件格式转换变得简单易用，希望能提高您的工作效率。 